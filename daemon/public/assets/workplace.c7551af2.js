var S=(p,b,i)=>new Promise((v,d)=>{var m=u=>{try{f(i.next(u))}catch(l){d(l)}},g=u=>{try{f(i.throw(u))}catch(l){d(l)}},f=u=>u.done?v(u.value):Promise.resolve(u.value).then(m,g);f((i=i.apply(p,b)).next())});import{g as K,a as Q,b as W,c as X,p as Y,d as Z,s as U}from"./workplace.6dc847cd.js";import{_ as ee,d as te,u as se,r,b as ae,aw as ne,aL as oe,o as w,h as ue,i as c,a as s,w as a,j as o,as as A,c as I,p as le,k as _e,l as h,x as ce,aT as re,aU as ie,q as de,a7 as pe,A as fe,ae as ve,n as me,s as ge,cE as ke,cF as he,a$ as be}from"./index.3790d147.js";var Ee="/assets/schoolboy.9f04cdf7.png";const N=p=>(le("data-v-477e71ab"),p=p(),_e(),p),Fe={class:"n-layout-page-header"},Be={class:"flex items-center"},Ce=N(()=>c("div",null,[c("p",{class:"px-4 text-xl"},"\u6B22\u8FCE\u767B\u5F55\u6570\u636E\u91C7\u96C6\u7CFB\u7EDF")],-1)),we={class:"flex justify-end w-full"},xe={class:"flex flex-1 flex-col justify-center text-right"},De=N(()=>c("span",{class:"text-secondary"},"\u5F53\u524D\u9879\u76EE",-1)),ye={class:"text-2xl"},Te=h(" \u8BBE\u7F6E\u91C7\u96C6\u4EFB\u52A1 "),Se=h(" \u7ED3\u675F\u91C7\u96C6\u4EFB\u52A1 "),Ue=h("\u5173\u95ED"),Ae=h("\u4FDD\u5B58"),Ie=te({setup(p){const b=se(),i=r(!1),v=r(""),d=r(!1),m=r([]),g=r([]),f=r([]),u=r(null),l=r(!1),t=ae({hasTask:!1,activeDrawer:!1,loading:!1,robot:null,scene:null,task:null}),q={robot:{required:!0,message:"\u8BF7\u9009\u62E9robot",trigger:"change"},scene:{required:!0,message:"\u8BF7\u9009\u62E9scene",trigger:"change"},task:{required:!0,message:"\u8BF7\u9009\u62E9task",trigger:"change"}};let x;const R=()=>{x=setInterval(()=>{K().then(n=>{i.value=n.is_running,v.value=n.task_name,d.value!=n.result&&(d.value=n.result),n.robot_id>0&&n.scene_id>0&&n.task_id>0?l.value=!0:l.value=!1})},1e3)},L=()=>{Q().then(n=>{m.value=n.data.map(e=>({label:e.name,value:e.robot_id+""}))}),W().then(n=>{g.value=n.data.map(e=>({label:e.name,value:e.id+""}))}),X().then(n=>{f.value=n.data.map(e=>({label:e.name,value:e.id+""}))}),E(),t.activeDrawer=!0},E=()=>{t.activeDrawer=!1,t.loading=!1,t.robot=null,t.scene=null,t.task=null},j=()=>{E()},M=n=>{var e;n.preventDefault(),(e=u.value)==null||e.validate(F=>{F?b.error("\u9A8C\u8BC1\u5931\u8D25"):(t.loading=!0,Y({robot_id:~~t.robot,scene_id:~~t.robot,task_id:~~t.task}).then(()=>{E(),l.value=!0}))})},O=()=>S(this,null,function*(){Z().then(()=>{l.value=!1})}),V=()=>{U({result:!0})},z=()=>{U({result:!1})};return ne(()=>{R()}),oe(()=>{clearInterval(x)}),(n,e)=>{const F=ce,D=re,$=ie,k=de,y=pe,T=fe,B=ve,C=me,P=ge,G=ke,H=he,J=be;return w(),ue("div",null,[c("div",Fe,[s(T,{bordered:!1,title:"\u5DE5\u4F5C\u53F0"},{default:a(()=>[s($,{cols:"2 s:1 m:1 l:2 xl:2 2xl:2",responsive:"screen"},{default:a(()=>[s(D,null,{default:a(()=>[c("div",Be,[c("div",null,[s(F,{circle:"",size:64,src:o(Ee)},null,8,["src"])]),Ce])]),_:1}),s(D,null,{default:a(()=>[c("div",we,[c("div",xe,[De,c("span",ye,A(i.value?"\u8FDB\u884C\u4E2D":"\u65E0")+" "+A(v.value),1)])])]),_:1})]),_:1}),s(T,{bordered:!1},{default:a(()=>[s(y,null,{default:a(()=>[l.value?(w(),I(k,{key:1,type:"warning",onClick:O},{default:a(()=>[Se]),_:1})):(w(),I(k,{key:0,type:"success",onClick:L},{default:a(()=>[Te]),_:1}))]),_:1})]),_:1})]),_:1})]),s(H,{show:o(t).activeDrawer,"onUpdate:show":e[3]||(e[3]=_=>o(t).activeDrawer=_),width:"50%","close-on-esc":!1,"mask-closable":!1},{default:a(()=>[s(G,{title:"\u8BBE\u7F6E\u4EFB\u52A1"},{footer:a(()=>[s(y,null,{default:a(()=>[s(k,{onClick:j},{default:a(()=>[Ue]),_:1}),s(k,{type:"info",loading:o(t).loading,onClick:M},{default:a(()=>[Ae]),_:1},8,["loading"])]),_:1})]),default:a(()=>[s(P,{ref_key:"formRef",ref:u,model:o(t),"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",rules:q},{default:a(()=>[s(C,{label:"robot",path:"robot"},{default:a(()=>[s(B,{value:o(t).robot,"onUpdate:value":e[0]||(e[0]=_=>o(t).robot=_),placeholder:"\u8BF7\u9009\u62E9robot",options:m.value},null,8,["value","options"])]),_:1}),s(C,{label:"scene",path:"scene"},{default:a(()=>[s(B,{value:o(t).scene,"onUpdate:value":e[1]||(e[1]=_=>o(t).scene=_),placeholder:"\u8BF7\u9009\u62E9scene",options:g.value},null,8,["value","options"])]),_:1}),s(C,{label:"task",path:"task"},{default:a(()=>[s(B,{value:o(t).task,"onUpdate:value":e[2]||(e[2]=_=>o(t).task=_),placeholder:"\u8BF7\u9009\u62E9task",options:f.value},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"]),s(J,{show:d.value,"onUpdate:show":e[4]||(e[4]=_=>d.value=_),"mask-closable":!1,"z-index":1e5,preset:"dialog",title:"\u8BBE\u7F6E\u6570\u636E\u7ED3\u679C",content:"\u8BF7\u9009\u62E9\u5F53\u524D\u7684\u91C7\u96C6\u7EC4\u7684\u6210\u529F\u72B6\u6001","positive-text":"\u6210\u529F","negative-text":"\u5931\u8D25",onPositiveClick:V,onNegativeClick:z},null,8,["show"])])}}});var Le=ee(Ie,[["__scopeId","data-v-477e71ab"]]);export{Le as default};
