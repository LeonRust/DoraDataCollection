var w=(_,b,r)=>new Promise((v,d)=>{var m=i=>{try{c(r.next(i))}catch(p){d(p)}},e=i=>{try{c(r.throw(i))}catch(p){d(p)}},c=i=>i.done?v(i.value):Promise.resolve(i.value).then(m,e);c((r=r.apply(_,b)).next())});import{T as H}from"./TableAction.4151f0b4.js";import{aF as y,d as K,z as Q,u as W,r as x,b as X,aw as Z,o as k,c as E,w as a,a as t,j as u,q as F,i as ee,l,v as C,x as ne,y as te,N as ae,ax as ue,m as oe,n as ie,cN as le,a7 as se,cO as _e,aY as re,aS as de,ad as ce,s as pe,cE as me,cF as ge,A as fe}from"./index.3790d147.js";import{P as he}from"./PlusOutlined.71de4daf.js";import{A as Fe,_ as be,a as ve}from"./ArchiveOutline.24497a89.js";import{_ as De}from"./RadioButton.222114b3.js";import"./sortable.esm.1502e2e1.js";import"./useDesignSetting.e02d28c9.js";import"./propTypes.15d30787.js";import"./FormOutlined.88898c98.js";import"./componentSetting.f3f6bdde.js";import"./index.esm.ed31f38f.js";import"./DownOutlined.25d3f8ea.js";function we(){return y.request({url:"/banner",method:"GET"})}function ke(_){return y.request({url:"/banner",method:"POST",data:_})}function Ee(_){return y.request({url:"/banner/"+_,method:"DELETE"})}const Ce=l(" \u65B0\u5EFA "),ye=l("\u5220\u9664"),Be=l(" \u786E\u8BA4\u8981\u5220\u9664\u5F53\u524D\u7684\u56FE\u6807icon\u5417? "),Ae={style:{"margin-bottom":"12px"}},xe=l(" \u70B9\u51FB\u6216\u8005\u62D6\u52A8\u6587\u4EF6\u5230\u8BE5\u533A\u57DF\u6765\u4E0A\u4F20 "),Te=l("\u663E\u793A"),Ne=l("\u9690\u85CF"),qe=l("\u5173\u95ED"),Pe=l("\u4FDD\u5B58"),Ye=K({setup(_){const b=[{title:"id",key:"id",width:50},{title:"\u540D\u79F0",key:"title",width:150},{title:"\u56FE\u50CF",key:"image",width:100,render(n){return C(ne,{size:48,src:n.image})}},{title:"\u662F\u5426\u9690\u85CF",key:"is_hide",width:80,render(n){return C(te,{type:n.is_hide?"error":"success"},{default:()=>n.is_hide?"\u9690\u85CF":"\u663E\u793A"})}},{title:"\u987A\u5E8F",key:"banner_order",width:80},{title:"\u64CD\u4F5C",key:"actions",width:100,render(n){return C(H,{style:"button",actions:[{label:"\u5220\u9664",icon:"ic:outline-delete-outline",onClick:q.bind(null,n)},{label:"\u7F16\u8F91",onClick:N.bind(null,n)}]})}}],r=Q(),v=W(),d=x(null),m=x([]),e=X({activeDrawer:!1,loading:!1,drawerTitle:"Banner\u7BA1\u7406",id:0,title:null,desc:null,image:null,image_path:null,link:null,is_hide:0,banner_order:255}),c={title:{required:!0,trigger:["blur","input"],message:"\u8BF7\u8F93\u5165\u540D\u79F0"}},i=()=>w(this,null,function*(){we().then(n=>{m.value=n.data})}),p=()=>{g(),e.activeDrawer=!0},g=()=>{e.activeDrawer=!1,e.loading=!1,e.activeDrawer=!1,e.loading=!1,e.id=0,e.title=null,e.desc=null,e.image=null,e.image_path=null,e.link=null,e.is_hide=0,e.banner_order=255},T=()=>{g()},N=n=>{g(),e.id=n.id,e.title=n.title,e.desc=n.desc,e.image=n.image,e.image_path=n.image_path,e.link=n.link,e.is_hide=n.is_hide,e.banner_order=n.banner_order,e.activeDrawer=!0},q=n=>{r.warning({title:"\u8B66\u544A",content:"\u786E\u5B9A\u8981\u5220\u9664\u5F53\u524D\u6570\u636E\uFF0C\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",onPositiveClick:()=>{Ee(n.id).then(()=>i())}})},P=({event:n})=>{if(n&&n.target.status==200){const o=JSON.parse(n.target.response);e.image=o.url,e.image_path=o.file_path}},$=()=>{e.image=null,e.image_path=null},z=n=>{var o;n.preventDefault(),(o=d.value)==null||o.validate(f=>{if(f)v.error("\u9A8C\u8BC1\u5931\u8D25");else{const D={id:e.id,title:e.title,desc:"",image:e.image_path,link:"",is_hide:e.is_hide,banner_order:e.banner_order};e.loading=!0,ke(D).then(()=>{g(),i()}).finally(()=>{e.loading=!1})}})};return Z(()=>w(this,null,function*(){i()})),(n,o)=>{const f=ae,D=ue,I=oe,h=ie,O=le,U=be,B=se,R=ve,S=_e,V=re,A=De,j=de,L=ce,M=pe,G=me,J=ge,Y=fe;return k(),E(Y,{bordered:!1,class:"proCard"},{default:a(()=>[t(u(F),{type:"primary",onClick:p},{default:a(()=>[t(f,null,{default:a(()=>[t(u(he))]),_:1}),Ce]),_:1}),t(D,{columns:b,data:m.value,bordered:!1},null,8,["data"]),t(J,{show:u(e).activeDrawer,"onUpdate:show":o[3]||(o[3]=s=>u(e).activeDrawer=s),width:"50%","close-on-esc":!1,"mask-closable":!1},{default:a(()=>[t(G,{title:u(e).drawerTitle},{footer:a(()=>[t(B,null,{default:a(()=>[t(u(F),{onClick:T},{default:a(()=>[qe]),_:1}),t(u(F),{type:"info",loading:u(e).loading,onClick:z},{default:a(()=>[Pe]),_:1},8,["loading"])]),_:1})]),default:a(()=>[t(M,{ref_key:"formRef",ref:d,model:u(e),"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",rules:c},{default:a(()=>[t(h,{label:"\u540D\u79F0",path:"title"},{default:a(()=>[t(I,{value:u(e).title,"onUpdate:value":o[0]||(o[0]=s=>u(e).title=s),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["value"])]),_:1}),t(h,{label:"\u56FE\u6807icon",path:"image"},{default:a(()=>[u(e).image&&u(e).image_path?(k(),E(B,{key:0,vertical:""},{default:a(()=>[t(O,{src:u(e).image,width:"100"},null,8,["src"]),t(U,{"show-icon":!1,onPositiveClick:$},{trigger:a(()=>[t(u(F),null,{default:a(()=>[ye]),_:1})]),default:a(()=>[Be]),_:1})]),_:1})):(k(),E(V,{key:1,"directory-dnd":"",action:"/api/admin/upload",accept:"image/png, image/jpeg",name:"image",onFinish:P},{default:a(()=>[t(S,null,{default:a(()=>[ee("div",Ae,[t(f,{size:"48",depth:3},{default:a(()=>[t(u(Fe))]),_:1})]),t(R,{style:{"font-size":"16px"}},{default:a(()=>[xe]),_:1})]),_:1})]),_:1}))]),_:1}),t(h,{label:"\u662F\u5426\u9690\u85CF"},{default:a(()=>[t(j,{value:u(e).is_hide,"onUpdate:value":o[1]||(o[1]=s=>u(e).is_hide=s)},{default:a(()=>[t(A,{value:0},{default:a(()=>[Te]),_:1}),t(A,{value:1},{default:a(()=>[Ne]),_:1})]),_:1},8,["value"])]),_:1}),t(h,{label:"\u987A\u5E8F"},{default:a(()=>[t(L,{value:u(e).banner_order,"onUpdate:value":o[2]||(o[2]=s=>u(e).banner_order=s),min:1,max:65535},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])]),_:1})}}});export{Ye as default};
